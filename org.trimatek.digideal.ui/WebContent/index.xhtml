<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">
<h:head>
	<title><h:outputText value="#{msg.form_new}"/></title>
	<link rel="stylesheet" href="./css/style.css" />
	<link rel="stylesheet" href="./css/showcase.css" />
</h:head>
<h:body>
	<p:tooltip position="top" />
	<h:form>
		<p:panelGrid style="margin-top:40px">
			<p:row style="height: 110px">
				<p:column style="font-weight: bold;"><h:outputText value="#{msg.form_whom}"/></p:column>
				<p:column>
					<p:panelGrid>
						<p:row>
							<div style="margin-left: auto; margin-right: 0;">
								<div class="ui-inputgroup">
									<span class="ui-inputgroup-addon"><h:outputText value="#{msg.form_this}"/></span>
									<p:growl id="msgs" showDetail="true" escape="false" />
								</div>
							</div>
						</p:row>
						<p:row>
							<div
								style="margin-left: auto; margin-right: 0; margin-top: 10px;">
								<div class="ui-inputgroup">
									<span class="ui-inputgroup-addon"><h:outputText value="#{msg.form_mrmrs}"/></span>
									<p:inputText id="namePayer" placeholder="#{msg.form_name_surname}" 
										value="#{contractView.namePayer}"
										style="#{contractView.namePayerStyle}">
										<p:ajax update="msgs,namePayer,preview" event="blur"
											listener="#{contractView.validatePayerName}" />
									</p:inputText>
									<span class="ui-inputgroup-addon"><h:outputText value="#{msg.form_now_on}"/></span>
									<p:inputText styleClass="nick" id="nickPayer"
										value="#{contractView.nickPayer}"
										placeholder="#{msg.form_payer_nick}" maxlength="16"
										style="#{contractView.nickPayerStyle}">
										<p:ajax event="blur"
											update="nickPayer,payer,msgs,nickPayer,preview"
											listener="#{contractView.handlePayerNick}" />
									</p:inputText>
									<span class="ui-inputgroup-addon"> {</span>
									<p:inputText
										pt:data-tooltip="#{contractView.addressPayerTooltip}"
										id="addressPayer" placeholder="#{msg.form_payer_bitcoin_address}" maxlength="35"
										value="#{contractView.addressPayer}"
										style="#{contractView.addressPayerStyle}">
										<p:ajax update="msgs,addressPayer,preview" event="blur"
											listener="#{contractView.validatePayerAddress}" />
									</p:inputText>

									<span class="ui-inputgroup-addon"> ,</span>
									<p:inputText id="emailPayer" value="#{contractView.emailPayer}"
										placeholder="#{msg.form_payer_email}" style="#{contractView.emailPayerStyle}">
										<p:ajax update="msgs,emailPayer,preview" event="blur"
											listener="#{contractView.validatePayerEmail}" />
									</p:inputText>
									<span class="ui-inputgroup-addon"> }</span> <span
										class="ui-inputgroup-addon"><h:outputText value="#{msg.form_and}"/></span>
								</div>
							</div>
							<div style="margin-left: auto; margin-right: 0;">
								<div class="ui-inputgroup">
									<span class="ui-inputgroup-addon"><h:outputText value="#{msg.form_mrmrs}"/></span>
									<p:inputText id="nameCollector" placeholder="#{msg.form_name_surname}"
										value="#{contractView.nameCollector}"
										style="#{contractView.nameCollectorStyle}">
										<p:ajax update="msgs,nameCollector,preview" event="blur"
											listener="#{contractView.validateCollectorName}" />
									</p:inputText>
									<span class="ui-inputgroup-addon"><h:outputText value="#{msg.form_now_on}"/></span>
									<p:inputText styleClass="nick" id="nickCollector"
										placeholder="#{msg.form_collector_nick}" maxlength="16"
										value="#{contractView.nickCollector}"
										style="#{contractView.nickCollectorStyle}">
										<p:ajax event="blur"
											update="nickCollector,msgs,collector,collector-cond,preview"
											listener="#{contractView.handleCollectorNick}" />
									</p:inputText>
									<span class="ui-inputgroup-addon"> {</span>
									<p:inputText
										pt:data-tooltip="#{contractView.addressCollectorTooltip}"
										id="addressCollector" placeholder="#{msg.form_collector_bitcoin_address}"
										maxlength="35" value="#{contractView.addressCollector}"
										style="#{contractView.addressCollectorStyle}">
										<p:ajax update="msgs,addressCollector,preview" event="blur"
											listener="#{contractView.validateCollectorAddress}" />
									</p:inputText>
									<span class="ui-inputgroup-addon"> ,</span>
									<p:inputText id="emailCollector"
										value="#{contractView.emailCollector}" placeholder="#{msg.form_collector_email}"
										style="#{contractView.emailCollectorStyle}">
										<p:ajax update="msgs,emailCollector,preview" event="blur"
											listener="#{contractView.validateCollectorEmail}" />
									</p:inputText>
									<span class="ui-inputgroup-addon"> }</span>
								</div>
							</div>
						</p:row>
					</p:panelGrid>
				</p:column>
			</p:row>
			<p:row style="height: 50px">
				<p:column style="font-weight: bold;"><h:outputText value="#{msg.form_how_much}"/></p:column>
				<p:column>
					<div style="margin-left: auto; margin-right: auto;">
						<div class="ui-inputgroup">
							<span class="ui-inputgroup-addon"><h:outputText value="#{msg.form_establishes_that}"/></span>
							<p:inputText styleClass="nick" id="payer"
								value="#{contractView.nickPayerValid}" readonly="true" />
							<span class="ui-inputgroup-addon"><h:outputText value="#{msg.form_will_pay}"/></span>
							<p:inputText styleClass="nick" id="collector"
								value="#{contractView.nickCollectorValid}" readonly="true" />
							<span class="ui-inputgroup-addon"><h:outputText value="#{msg.form_sum_of}"/></span>
							<p:selectOneMenu id="currencies"
								value="#{contractView.selectedCurrency}" style="width:60px">
								<p:ajax listener="#{contractView.onCurrencyChange}"
									update="btc,preview" />
								<f:selectItems value="#{contractView.currencies}" />
							</p:selectOneMenu>
							<p:inputText id="money" value="#{contractView.quantity}"
								style="#{contractView.quantityStyle}" styleClass="money">
								<p:ajax event="blur" update="btc,money,preview"
									listener="#{contractView.handleQuantity}" />
							</p:inputText>
							<span class="ui-inputgroup-addon"><h:outputText value="#{msg.form_equivalent_to}"/></span>
							<p:inputText id="btc" value="BTC #{contractView.btc}"
								readonly="true" style="width:125px" />
						</div>
					</div>
				</p:column>
			</p:row>
			<p:row style="height: 80px">
				<p:column style="font-weight: bold;"><h:outputText value="#{msg.form_condition}"/></p:column>
				<p:column>
					<div style="margin-left: auto; margin-right: 0;">
						<div class="ui-inputgroup">
							<span class="ui-inputgroup-addon"><h:outputText value="#{msg.form_if}"/></span>
							<p:inputTextarea id="collector-cond" rows="3" cols="10"
								value="#{contractView.nickCollector}" readonly="true" />
							<span class="ui-inputgroup-addon"><h:outputText value="#{msg.form_delivers_in}"/></span>
							<p:inputTextarea styleClass="textArea" rows="3" cols="36"
								id="address" value="#{contractView.address}"
								style="#{contractView.addressStyle}"
								placeholder="#{msg.form_example_address}">
								<p:ajax event="blur" update="address,msgs,preview"
									listener="#{contractView.validateAddress}" />
							</p:inputTextarea>
							<span class="ui-inputgroup-addon"><h:outputText value="#{msg.form_the_next}"/></span>
							<p:inputTextarea styleClass="textArea" rows="3" cols="43"
								id="item" value="#{contractView.item}"
								style="#{contractView.itemStyle}"
								placeholder="#{msg.form_example_product_service}">
								<p:ajax event="blur" update="item,msgs,preview"
									listener="#{contractView.validateItem}" />
							</p:inputTextarea>
						</div>
					</div>
				</p:column>
			</p:row>
			<p:row style="height: 50px">
				<p:column style="font-weight: bold;"><h:outputText value="#{msg.form_guarantor}"/></p:column>
				<p:column>
					<div style="margin-left: auto; margin-right: 0;">
						<div class="ui-inputgroup">
							<span class="ui-inputgroup-addon"><h:outputText value="#{msg.form_supervised_by}"/></span>
							<p:inputText id="nickagent" value="#{contractView.agentNick}"
								readonly="true" styleClass="nick" />
							<span class="ui-inputgroup-addon"> {</span>
							<p:inputText pt:data-tooltip="#{contractView.agentAddress}"
								value="#{contractView.agentAddress}" readonly="true"
								style="width:210px" />
							<span class="ui-inputgroup-addon"> ,</span>
							<p:inputText value="#{contractView.agentEmail}" readonly="true"
								style="width:195px" />
							<span class="ui-inputgroup-addon"> }</span>
						</div>
					</div>
				</p:column>
			</p:row>
			<p:row styleClass="buttonsbar">
				<p:column style="border-right-style: hidden;"></p:column>
				<p:column>
					<div style="float: right;">
						<h:panelGrid columns="3" style="margin-bottom:10px"
							cellpadding="5">
							<p:outputLabel for="@next" value="#{msg.data_true}" />
							<p:selectBooleanCheckbox id="check"
								value="#{contractView.dataAuthentic}">
								<p:ajax update="preview" />
							</p:selectBooleanCheckbox>
							<p:commandButton value="Previsualizar" id="preview"
								actionListener="#{contractView.previewAction}"
								disabled="#{contractView.previewDisabled}" 
								icon="ui-icon-circle-zoomin" onclick="PF('draftDlg').show();"
								update="draft,paneldialog,confirmbtn,panelbar">
							</p:commandButton>
						</h:panelGrid>
					</div>
				</p:column>
			</p:row>
		</p:panelGrid>
		<p:remoteCommand name="cancelDraft"
			update="draft,check,preview,paneldialog,panelbar"
			actionListener="#{contractView.cancelDraftAction}" />
		<p:remoteCommand name="confirmDraft"  
			actionListener="#{contractView.confirmDraftAction}" >
		</p:remoteCommand>
		<p:dialog id="previewDialog" widgetVar="draftDlg" showEffect="fade"
			position="center" positionType="absolute" closable="false"
			showHeader="false" modal="true" width="600px" height="380px"
			draggable="false" resizable="false">
			<br />
			<br />
			<div class="dialog">
				<p:outputLabel id="draft" value="#{contractView.draft}"
					escape="false" />
				<br /> <br />
				<p:panelGrid layout="grid" styleClass="ui-noborder" id="panelbar"
					columns="1">
					<p:progressBar id="progressbar" style="height:6px"
						mode="indeterminate" rendered="#{contractView.renderProgressbar}" />
				</p:panelGrid>
				<p:panelGrid layout="grid" styleClass="ui-noborder" id="paneldialog"
					columns="6">
					<h:outputText value="" />
					<h:outputLink value="#">
						<h:outputText id="signpayer"
							value="#{contractView.nickPayerValid}"
							rendered="#{contractView.renderSignatures}" />
					</h:outputLink>
					<p:tooltip for="signpayer" value="#{contractView.tooltipPayer}"
						position="bottom" rendered="#{contractView.renderSignatures}" />
					<h:outputText value="" />
					<h:outputLink value="#">
						<h:outputText id="signcollector"
							value="#{contractView.nickCollectorValid}"
							rendered="#{contractView.renderSignatures}" />
					</h:outputLink>
					<p:tooltip for="signcollector"
						value="#{contractView.tooltipCollector}" position="bottom" />
				</p:panelGrid>
			</div>
			<div style="float: right;">
				<br />
				<p:commandButton id="confirmbtn" value="#{msg.btn_confirm}"
					type="button" styleClass="ui-confirmdialog-yes"
					icon="ui-icon-check" action="result"
					onclick="confirmDraft();PF('draftDlg').hide();"
					disabled="#{contractView.confirmDraftDisabled}" />
				<p:commandButton value="#{msg.btn_cancel}" type="button"
					styleClass="ui-confirmdialog-no"
					onclick="cancelDraft();PF('draftDlg').hide();" icon="ui-icon-close" />
			</div>
		</p:dialog>
	</h:form>
</h:body>
</html>